<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.modules.ad.mapper.AdInspectionMapper">

    <!-- 微信分页列表查询 -->
    <select id="queryPageVxList" resultType="org.jeecg.modules.ad.entity.Vo.AdInspectionVO">
        SELECT 
            ai.id,
            av.vehicle_type,
            av.plate_number,
            av.brand,
            av.model,
            av.company_name,
            ap.name as ad_name,
            ap.launch_end_time,
            av.status
        FROM 
            ad_inspection ai
        LEFT JOIN 
            ad_vehicle av ON ai.vehicle_id = av.id
        LEFT JOIN 
            ad_publish ap ON av.ad_id = ap.id
        WHERE 
            1=1
            <if test="adName != null and adName != ''">
                AND ap.name LIKE CONCAT('%', #{adName}, '%')
            </if>
        ORDER BY 
            ai.create_time DESC
    </select>

    <!-- 获取总记录数 -->
    <select id="selectCount" resultType="java.lang.Long">
        SELECT 
            COUNT(1)
        FROM 
            ad_inspection ai
        LEFT JOIN 
            ad_vehicle av ON ai.vehicle_id = av.id
        LEFT JOIN 
            ad_publish ap ON ai.ad_id = ap.id
        WHERE 
            1=1
            <if test="adName != null and adName != ''">
                AND ap.name LIKE CONCAT('%', #{adName}, '%')
            </if>
    </select>

</mapper>